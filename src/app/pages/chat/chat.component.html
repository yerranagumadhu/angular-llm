<dx-drawer
  [opened]="drawerOpened"
  [openedStateMode]="'shrink'"
  [position]="'left'"
  [minSize]="50"
  [revealMode]="'expand'"
  [template]="'drawerTemplate'"
  [height]="'100%'"
>
  <!-- Main Chat Box -->
  <div *dxTemplate="let data of 'content'">
    <div class="chat-header" *ngIf="selectedChat">
      <h3>{{ selectedChat.title }}</h3>
    </div>

    <dx-chat
      *ngIf="selectedChat"
      [dataSource]="chatMessages"
      [user]="currentUser"
      height="700"
      (onMessageEntered)="onMessageEntered($event)"
    ></dx-chat>
  </div>

  <!-- Drawer Content -->
  <div *dxTemplate="let data of 'drawerTemplate'">
    <div class="drawer-header">
      <button (click)="toggleDrawer()">
        {{ drawerOpened ? '<<' : '>>' }}
      </button>
      <h4 *ngIf="drawerOpened">Chat Sessions</h4>
    </div>
    <dx-accordion
      *ngIf="drawerOpened"
      [items]="groupedChats"
      [collapsible]="true"
      [multiple]="true"
    >
      <div *dxTemplate="let data of 'title'">
        {{ data.date }}
      </div>
      <div *dxTemplate="let data of 'item'">
        <dx-list
          [items]="data.displayedChats"
          displayExpr="title"
          (onItemClick)="onChatSelect($event)"
        ></dx-list>
        <div *ngIf="data.chats.length > 5" class="show-toggle">
          <button (click)="toggleExpand(data)">
            {{ data.expanded ? 'Show less' : 'Show more' }}
          </button>
        </div>
      </div>
    </dx-accordion>
  </div>
</dx-drawer>
